<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Recruitment</title>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/space10-community/conversational-form@1.0.1/dist/conversational-form.min.js" crossorigin></script>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <script>
            window.onload = function () {
		var q, formData;
                var conversationalForm = window.cf.ConversationalForm.startTheConversation({
                    formEl: document.getElementById("form"),
                    context: document.getElementById("cf-context"),
                    robotImage: "https://avatars2.githubusercontent.com/u/44554603?s=280&v=4",

                    submitCallback: function () {
                        conversationalForm.addRobotChatResponse("Alright, you're done. Keep an eye on your inbox!");
			var formData = conversationalForm.getFormData(true);
			formData['ibques'] = q;
			send(formData);    
			console.log(formData);
			// Have to post data to backend here
			//document.getElementById("form").submit();

                    },
                });

		// Icebreaker question module.
                var qa = new Map();

                // Questions to be asked, followed by the response to be given.
                qa.set("What is your favourite movie?", "On to my watchlist it goes! My favourite is Tron : Legacy.");

                qa.set("If you could choose any person from history to be your imaginary friend, who would it be?", "Interesting person indeed! Personally, I would love to hang out with my inspiration, Alan Turing.");

                qa.set("What is your favourite song?", "Must be a great tune! I keep jamming to Stayin' Alive by The Bee Gees.");

                qa.set("You can have an unlimited supply of one thing for the rest of your life, what is it?", "Brilliant priorities! I'd personally want an unlimited supply of games!");

                qa.set(
                    "If you could choose any person from history to be your imaginary friend, who would it be and why?",
                    "I'd love to come there sometime. If you can, try and visit the Computer History Museum in California, because that's where you will find me."
                );

                qa.set("If you could be guaranteed one thing in life (besides money), what would it be?", "Fascinating! I need a guarantee of clean code all through my life!");

                qa.set("Would you rather be the funniest or smartest person in the room?", "Interesting! I'd personally prefer to be the funniest person in the room!");

                qa.set("What is your favorite TV show?", "I should make sure and check that out. My favourite show has got to be Mr. Robot!");

                qa.set("If you could be granted one superpower, what would it be?", "Interesting! I would love to have unlimited processing power!");

                qa.set("If you could start a charity, what would it be for?", "A noble thought indeed. I would want to make knowledge and learning accessible to everyone in the world.");

                // Pick any question at random from the above.
                var counter = 0;
                var randomIndex = Math.floor(Math.random() * Math.floor(10));
                for (let [question, response] of qa) {
                    if (counter == randomIndex) {
                        document.getElementById("icebreakerquestion").setAttribute("cf-questions", question);
			q = question;
                        document.getElementById("icebreakerresponse").setAttribute("cf-questions", response);
                        break;
                    } else counter++;
                }
	};


function send(formData){
       	 	$.ajax({
            		type : 'post',
            		url : 'register.php',
            		data : formData,
            		dataType : 'json',
            		encode : true,

            		success : function(response){
				console.log(response);
			response = JSON.parse(response);

                if(response== "ok"){
			console.log('helllo');
                }else{

                    console.log('erro');
                }

            }

        });
}

</script>	
        </script>
        <style>
            #cf-context {
                width: 100vw;
                height: 100vh;
            }
            #form {
                opacity: 0;
            }
        </style>
    </head>
    <body>
        <datalist id="domain">
            <option value="Programming"> </option>
            <option value="Web Development"> </option>
            <option value="Hacking"> </option>
            <option value="Machine Learning"> </option>
            <option value="Blockchain"> </option>
        </datalist>

	<form id="form" cf-form> 
            <cf-robot-message cf-questions="Hey! My name is A.L.A.N"></cf-robot-message>

            <input type="text" name="name" id="name" cf-questions="What should I call you?" cf-validation="namecheck" required cf-error="Enter your name!"/>

            <input type="email" name="email" id="emaill" cf-questions="Hi {name}! Can you please tell me your email?" required cf-error="Enter your email!"/>

            <input type="tel" name="phone" id="phonee" pattern="[0-9]{10}" minLength="10" maxlength="10" cf-questions="Could I get your phone number as well?" required cf-error="Enter a valid phone number!" />

            <input type="text" name="roll" id="rolll" minlength="10" maxLength="10" cf-questions="I'll need your roll number please." required cf-error="Enter a valid roll number!" />

            <fieldset cf-questions="Select your branch:">
                <input type="radio" name="branch" id="cse" cf-label="CSE" value="CSE" />
                <input type="radio" name="branch" id="it" cf-label="IT" value="IT" />
                <input type="radio" name="branch" id="ece" cf-label="ECE" value="ECE" />
                <input type="radio" name="branch" id="eee" cf-label="EEE" value="EEE" />
                <input type="radio" name="branch" id="mech" cf-label="MECH" value="MECH" />
                <input type="radio" name="branch" id="civil" cf-label="CIVIL" value="CIVIL" />
                <input type="radio" name="branch" id="mba" cf-label="MBA" value="MBA" />
            </fieldset>

            <fieldset cf-questions="Select your year: ">
                <input type="radio" name="yr" id="first" cf-label="1" value="1" />
                <input type="radio" name="yr" id="second" cf-label="2" value="2" />
                <input type="radio" name="yr" id="third" cf-label="3" value="3" />
                <input type="radio" name="yr" id="fourth" cf-label="4" value="4" />
            </fieldset>

            <fieldset cf-questions="Select your section: ">
                <input type="radio" name="sec" id="asec" cf-label="A" value="A" />
                <input type="radio" name="sec" id="bsec" cf-label="B" value="B" />
                <input type="radio" name="sec" id="csec" cf-label="C" value="C" />
                <input type="radio" name="sec" id="dsec" cf-label="D" value="D" />
            </fieldset>

            <fieldset cf-questions="Which domain is the closest to you? (Swipe to see more)">
                <input cf-label="Programming" id="prog" type="radio" cf-image="./resources/terminal.png" name="domain" tabindex="6" value="Programming" />
                <input cf-label="Web Dev" id="webd" type="radio" cf-image="./resources/webdev.jpg" name="domain" tabindex="6" value="Web Development" />
                <input cf-label="Cyber Security" id="cybe" type="radio" cf-image="./resources/cyber.png" name="domain" tabindex="6" value="Cyber Security" />
                <input cf-label="ML / AI" id="mlai" type="radio" cf-image="./resources/ml.png" name="domain" tabindex="6" value="Machine Learning" />
                <input cf-label="Blockchain" id="bloc" type="radio" cf-image="./resources/bc.png" name="domain" tabindex="6" value="Blockchain" />
            </fieldset>

            <input type="text" name="ibresp" id="icebreakerquestion" cf-questions="" required cf-error="This is a mandatory question." />
            <cf-robot-message id="icebreakerresponse" cf-questions=""></cf-robot-message>
        </form>
        <div id="cf-context" role="cf-context" cf-context></div>
    </body>
</html>
